<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Heavy Metal Festival - Rio de Janeiro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!--JQUERY-->
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <!--BOOTSTRAP ICONS-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <!--CHATROOM CDN-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@scalableminds/chatroom@0.12/dist/Chatroom.min.css">
  </head>
  <body style="background-color: gray;">
    

    <div class="container-fluid">
        <div class="row" style="background-color: black;">
            <nav class="navbar navbar-expand-lg navbar-dark " style="background-color: black;"> 
                <a class="navbar-brand" style="cursor: pointer;" data-bs-toggle="modal" data-bs-target="#exampleModal">
                    <img src="images/HEAVY METAL FESTIVAL.jpg" alt="Bootstrap" width="90" height="90">
                  </a>
            <div class="container-fluid">
                
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav">
                    <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#">Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Atrações
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Iron Maiden</a></li>
                            <li><a class="dropdown-item" href="#">Metallica</a></li>
                            <li><a class="dropdown-item" href="#">Kiss</a></li>
                            <li><a class="dropdown-item" href="#">Guns N Roses</a></li>
                            <li><a class="dropdown-item" href="#">Avenged Sevenfold</a></li>
                            <li><a class="dropdown-item" href="#">Bullet For My Valentine</a></li>
                            <li><a class="dropdown-item" href="#">Slipknot</a></li>
                            <li><a class="dropdown-item" href="#">Ghost</a></li>
                        </ul>
                      </li>
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Ingressos
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Garanta seu ingresso</a></li>
                            <li><a class="dropdown-item" href="pcd.html">Ingressos para PCD</a></li>
                            
                        </ul>
                      </li>
                    <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Opções do usuário
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Cadastre-se</a></li>
                        <li><a class="dropdown-item" href="#">Login</a></li>
                        <li><a class="dropdown-item" href="#">LGPD</a></li>
                    </ul>
                    </li>
                </ul>
                </div>
            </div>
        </nav>
        </div>

    </div>

    <div class="container-fluid">
        
        <div class="row" style="background-color: black;">
            <div id="carouselExampleIndicators"  class="carousel slide mx-auto" style="width: 1000px;" data-bs-ride="true">
                <div class="carousel-indicators">
                  <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                  <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                  <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
                  <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4"></button>
                </div>
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <img src="images/02 DE SETEMBRO DE 2023.jpg" height="400px"  class="d-block w-100" alt="...">
                  </div>
                  <div class="carousel-item">
                    <img src="images/03 DE SETEMBRO DE 2023.jpg" height="400px" class="d-block w-100" alt="...">
                  </div>
                  <div class="carousel-item">
                    <img src="images/09 DE SETEMBRO DE 2023.jpg" height="400px" class="d-block w-100" alt="...">
                  </div>
                  <div class="carousel-item">
                    <img src="images/10 DE SETEMBRO DE 2023.jpg" height="400px" class="d-block w-100" alt="...">
                  </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Next</span>
                </button>
              </div>
        </div>

        <div class="row ">
            <div class="col-auto">
                <span><strong>ATENÇÃO:</strong> O valor inteiro do ingresso é de <strong>R$700,00</strong>. O desconto dar-se-á com base na distância de deslocamento até o local do festival!</span>
            </div>
        </div>

        <div class="row">
            

            <div class="col-auto mx-auto">
                <div class="row">
                  <div class="col-auto">
                    <div class="mb-3">
                      <label for="nome_cidades" class="form-label"><strong>Saída</strong></label>
                      <select class="form-select" id="nome_cidades" aria-label="Default select example">
                        
                      </select>
                    </div>
                  </div>

                  <div class="col-auto">
                    <div class="mb-3">
                      <label for="saida" class="form-label"><strong>Distância</strong></label>
                      <input type="number" class="form-control" required onkeypress="calcula_valor()" ng-model="distancia" name="distancia"   id="distancia" placeholder="Distância">
                    </div>
                  </div>
                </div>
                
                  
                  <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label"><strong>Destino</strong></label>
                    <input type="text" class="form-control" id="exampleFormControlInput1" style="text-transform: uppercase;" value="Rio de Janeiro" readonly>
                  </div>

                  <div class="row">
                    <div class="col-auto">
                      <div class="mb-3">
                        <label for="porcentagem_desconto" class="form-label"><strong>Desconto em porcentagem</strong></label>
                        <input type="text" class="form-control" id="porcentagem_desconto"  readonly>
                      </div>
                    </div>
                    <div class="col-auto">
                      <div class="mb-3">
                        <label for="valor_ingresso" class="form-label"><strong>Valor do ingresso com o desconto</strong></label>
                        <input type="text" class="form-control" id="valor_ingresso"  readonly>
                      </div>
                    </div>
                  </div>
                  
            </div>
        </div>
    </div>


    <!--CHAT BUTTON-->
    <div class="container-fluid">
      <div class="row">
        <button class="blob green" title="Iniciar Chat"  onclick="openForm()"><i class="bi bi-chat-dots"></i></button>

        <div class="col-4 chat-popup"  role='alert' id="myForm">
          <div class="row" style="float: right;">
            <button type='button' title='Sair da conversa' onclick="closeForm()"  id='btn_excluir' class='btn_fechar' title='Excluir Campo' data-bs-dismiss='alert' >
              <strong>X</strong>
            </button>
          </div>
          <div class="chat-container"></div>
          <div class='row'>
            
          </div>
        </div>
      </div>
    </div>

    <!--MODAL INFORMAÇÃO DO FESTIVAL-->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content" style="background-color: gray;">
          <div class="modal-header ">
            <h5 class="modal-title">Heavy Metal Festival 2023</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            O <strong>Heavy Metal Festival 2023</strong> será realizado pela primeira vez em sua história na cidade do Rio de Janeiro.
            O intuito do festival é reunir as maiores bandas de metal do mundo e da atualidade.
            Serão quatro dias de muito metal, stand`s de patrocinadores, brinquedos e diversão para todo o público do Brasil.
            Com o intuito de trazer mais frequentadores, os idealizadores do festival tiveram a idéia de criar o benefício do desconto do ingresso 
            com base na distância de deslocamento da pessoa até a cidade do Rio de Janeiro. Para os moradores da cidade maravilhosa, basta apresentar 
            um comprovante de residência e 1 kg de alimento não perecível para poder obter seu desconto.

            O Heavy Metal Festival 2023 contará com a presença de monstros do metal como Iron Maiden, Metallica, Kiss, entre outros. 
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Sair</button>
          </div>
        </div>
      </div>
    </div>

    <script>


        function openForm() {
        document.getElementById("myForm").style.display = "block";

        var chatroom = new window.Chatroom({
            host: "http://localhost:5005",
            title: "Chat",
            container: document.querySelector(".chat-container"),
            welcomeMessage: "Olá. Seja bem-vindo(a) ao Chat! Inicie sua conversa, enviando-nos um 'Oi'"
        });
        chatroom.openChat();
      }

      function closeForm() {
        document.getElementById("myForm").style.display = "none";
      }

    async function dados_cidades(){
    fetch("./dados.json")
    .then(function(resp){
      return resp.json();
    })
    .then(function(data){
        nome_cidades='';
        escolha ='<option selected>Escolha uma opção</option>';
      for (i=0;i<data.length;i++){
        
        nomes =`<option value="${data[i].distancia}">${data[i].cidade}</option>`;
        
        nome_cidades += nomes;
        console.log(data[i].cidade);
        console.log(data[i].distancia);

        let container = document.querySelector('#nome_cidades');
        container.innerHTML = escolha + nome_cidades;
      }
      
   });
  }
  dados_cidades();

  $('#nome_cidades').change(function(event){
      var distancia = event.currentTarget.value;
      $("#distancia").val(distancia);
      console.log(distancia);
      var distancia = $("#distancia").val();
            //HAVERÁ UM DESCONTO DE R$20,00 A CADA 100KM PERCORRIDO
      var valor_desconto = distancia/20;
            
      var x = valor_desconto*100;
      var valor_ingresso = 700;
      var aux = x/700
      var valor_total = 700*(aux/100);
      console.log("PORCENTAGEM: " + aux.toFixed(2));
      console.log("VALOR TOTAL DO DESCONTO: " + valor_total.toFixed(2));
      var novo_valor = valor_ingresso - valor_total;
      console.log("VALOR A SER PAGO: " + novo_valor.toFixed(2));
      $("#porcentagem_desconto").val(aux.toFixed(2).concat("%"));
      $("#valor_ingresso").val("R$ ".concat(novo_valor.toFixed(2)));
    });

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" ></script>
    <script src="https://cdn.jsdelivr.net/npm/@scalableminds/chatroom@0.12/dist/Chatroom.min.js"></script>

    <style>
      .btn_fechar{
        background-color: red;
        color: white;
        border-radius: 40px;
        border-color: #ddd;
      }
      /* Button used to open the chat form - fixed at the bottom of the page */
      

      /* The popup chat - hidden by default */
      .chat-popup {
        display: none;
        position: fixed;
        bottom: 0;
        right: 15px;
        
        z-index: 9;
      }

      /* Add styles to the form container */
      .form-container {
        max-width: 300px;
        padding: 10px;
        background-color: white;
      }

      /* Full-width textarea */
      .form-container textarea {
        width: 100%;
        padding: 15px;
        margin: 5px 0 22px 0;
        border: none;
        background: #f1f1f1;
        resize: none;
        min-height: 200px;
      }

      /* When the textarea gets focus, do something */
      .form-container textarea:focus {
        background-color: #ddd;
        outline: none;
      }

      /* Set a style for the submit/send button */
      .form-container .btn {
        background-color: #04AA6D;
        color: white;
        padding: 16px 20px;
        border: none;
        cursor: pointer;
        width: 100%;
        margin-bottom:10px;
        opacity: 0.8;
      }

      /* Add a red background color to the cancel button */
      .form-container .cancel {
        background-color: red;
      }

      /* Add some hover effects to buttons */
      .form-container .btn:hover, .open-button:hover {
        opacity: 1;
      }

      

    .blob.green {
      background: rgba(51, 217, 178, 1);
      box-shadow: 0 0 0 0 rgba(51, 217, 178, 1);
      animation: pulse-green 2s infinite;
      border-radius: 50px;
      background-color: green;
      color: white;
      padding: 16px 20px;
      border: none;
      cursor: pointer;
      opacity: 0.8;
      position: fixed;
      bottom: 23px;
      right: 28px;
      width: 60px;
    }

    @keyframes pulse-green {
      0% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(7, 223, 54, 0.945);
      }
      
      70% {
        transform: scale(1);
        box-shadow: 0 0 0 10px rgba(51, 217, 178, 0);
      }
      
      100% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(51, 217, 178, 0);
      }
    }

    </style>
  </body>
</html>